FELICITY EVENT MANAGEMENT SYSTEM - DEPLOYMENT INFO
==================================================

Frontend URL: <INSERT_VERCEL_URL_HERE>
Backend URL: <INSERT_RENDER_URL_HERE>

--------------------------------------------------

DEPLOYMENT GUIDE
================
This guide covers deploying the specific Felicity EMS stack:
- Backend: Node.js/Express on Render
- Frontend: React on Vercel
- Database: MongoDB Atlas

## PREREQUISITES

1. Render Account (https://render.com/)
2. Vercel Account (https://vercel.com/)
3. MongoDB Atlas Account (https://www.mongodb.com/cloud/atlas)
4. GitHub Repository with the project code.

---

## PART 1: DATABASE SETUP (MongoDB Atlas)

1. Create a Cluster:
   - Log in to MongoDB Atlas and create a free tier cluster.

2. Configure Network Access:
   - Go to "Network Access" in the sidebar.
   - Click "Add IP Address".
   - Select "Allow Access from Anywhere" (0.0.0.0/0). This is required for Render to connect.

3. Create Database User:
   - Go to "Database Access".
   - Create a new user (e.g., `felicity_admin`).
   - Generate a strong password and save it.

4. Get Connection String:
   - Click "Connect" on your cluster.
   - Choose "Drivers" (Node.js).
   - Copy the connection string. It looks like:
     `mongodb+srv://<username>:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority`
   - Replace `<password>` with your actual password.

---

## PART 2: BACKEND DEPLOYMENT (Render)

1. Create Web Service:
   - Go to Render Dashboard -> New -> Web Service.
   - Connect your GitHub repository.

2. Configure Service:
   - Name: `felicity-backend` (or similar)
   - Root Directory: `backend` (CRITICAL STEP)
   - Runtime: Node
   - Build Command: `npm install`
   - Start Command: `npm start`

3. Environment Variables (Advanced):
   - Add the following keys:
     - NODE_ENV: production
     - MONGO_URI: (Paste your Atlas connection string from Part 1)
     - JWT_SECRET: (A long, random string for security)
     - RECAPTCHA_SECRET_KEY: (Your Google reCAPTCHA Secret Key)
     - FRONTEND_URL: (Leave temporary or put `*` for now, update after Vercel deploy)

4. Deploy:
   - Click "Create Web Service".
   - Wait for the build to finish.
   - Copy the URL provided by Render (e.g., `https://felicity-backend.onrender.com`).

   *Note: Render free tier spins down after inactivity. The first request might take 30-50 seconds.*

---

## PART 3: FRONTEND DEPLOYMENT (Vercel)

1. Create Project:
   - Go to Vercel Dashboard -> Add New -> Project.
   - Import your GitHub repository.

2. Configure Project:
   - Framework Preset: Create React App (should auto-detect).
   - Root Directory: Edit and select `frontend`.

3. Environment Variables:
   - Add the following keys:
     - REACT_APP_API_URL: (The Render Backend URL from Part 2, e.g., https://felicity-backend.onrender.com/api)
     - REACT_APP_RECAPTCHA_SITE_KEY: (Your Google reCAPTCHA Site Key)

4. Deploy:
   - Click "Deploy".
   - Vercel will build and assign a domain (e.g., `https://felicity-frontend.vercel.app`).

---

## PART 4: FINAL CONFIGURATION

1. Update Backend CORS:
   - Go back to Render Dashboard -> Environment.
   - Update `FRONTEND_URL` to your new Vercel URL (Remove trailing slash, e.g., `https://felicity-frontend.vercel.app`).
   - Redeploy/Restart the backend service if needed (Render usually auto-deploys on env change).

2. Verify:
   - Open your Vercel URL.
   - Try to Register/Login.
   - If you see Network Errors, check the Browser Console (F12) to ensure the API URL is correct.

---

## TROUBLESHOOTING

- 404 Errors on Refresh:
  - Ensure `vercel.json` exists in `frontend/` with rewrite rules (already included in project).

- CORS Errors:
  - Check that `FRONTEND_URL` in Render matches the Vercel URL exactly (https vs http, no trailing slash).

- Image Uploads Disappear:
  - Render's ephemeral file system deletes local files on restart.
  - This project uses local storage (`uploads/`). For production persistence, integration with Cloudinary or AWS S3 is recommended.

- "Connection Refused" to Database:
  - Ensure MongoDB Atlas Network Access is set to `0.0.0.0/0`.
